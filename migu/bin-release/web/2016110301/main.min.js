var Base=function(e){function t(){e.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(t,e);var i=(__define,t),a=i.prototype;return a.onAddToStage=function(){},a.getImage=function(e){var t=new egret.Bitmap;return t.texture=RES.getRes(e),t},a.setPosition=function(e,t,i,a){switch(void 0===t&&(t=0),void 0===i&&(i=0),void 0===a&&(a="none"),a){case"none":e.x=t,e.y=i;break;case"both":e.x=(this.width-e.width)/2,e.y=(this.height-e.height)/2;break;case"center":e.x=(this.width-e.width)/2,e.y=i;break;case"vertical":e.x=t,e.y=(this.height-this.height)/2;break;default:e.x=t,e.y=i}e.x+=e.anchorOffsetX,e.y+=e.anchorOffsetY},a.setCenter=function(e,t){switch(void 0===t&&(t="none"),t){case"both":e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2;break;case"center":e.anchorOffsetX=e.width/2;break;case"vertical":e.anchorOffsetY=e.height/2}},t}(egret.DisplayObjectContainer);egret.registerClass(Base,"Base");var FirstScreen=function(e){function t(){e.call(this),this.angle=0,this.c_x=0,this.c_y=0,this.c_r=0,this.resArr=[77,77,77,77,77],this.createElement()}__extends(t,e);var i=(__define,t),a=i.prototype;return a.onAddToStage=function(){},a.createElement=function(){var e=this;this.bg=this.getImage("bg_jpg"),this.setPosition(this.bg,0,0),this.addChildAt(this.bg,0),this.logo=this.getImage("logo_png"),this.setPosition(this.logo,17,18),this.addChildAt(this.logo,-1),this.clock=this.getImage("clock_png"),this.setCenter(this.clock,"both"),this.setPosition(this.clock,42,27),this.addChild(this.clock),egret.Tween.get(this.clock).to({rotation:0,scaleX:1.66,scaleY:1.66,alpha:0}).to({rotation:30,scaleX:1,scaleY:1,alpha:1},1300),this.title=this.getImage("title_png"),this.setCenter(this.title,"both"),this.setPosition(this.title,199,250),this.addChild(this.title),egret.Tween.get(this.title).to({scaleX:.8,scaleY:.8,alpha:0}).to({scaleX:1,scaleY:1,alpha:1},1300).call(function(){e.touchEnabled=!0}),this.arrow=this.getImage("arrow_png"),this.setPosition(this.arrow,76,779),this.addChild(this.arrow),this.btn=this.getImage("btn_png"),this.setPosition(this.btn,254,229),this.addChild(this.btn),this._mask=new egret.Shape,this.c_r=444,this.c_x=589,this.c_y=518,this.angle=90,this._mask.x=this.c_x,this._mask.y=this.c_y;var t=this._mask.graphics;t.beginFill(16711680),t.lineTo(0,-this.c_r),t.drawArc(0,0,this.c_r,90*Math.PI/180,Math.PI*this.angle/180,!1),t.lineTo(0,0),t.endFill(),this.addChild(this._mask),this.btn.mask=this._mask,this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onFirstQuestion,this),this.once(egret.TouchEvent.TOUCH_TAP,function(){egret.Tween.get(e.clock).to({rotation:e.clock.rotation+360},1400,egret.Ease.quadInOut),egret.Tween.get(e.title).to({alpha:0},300).call(function(){e.removeChild(e.title)}),setTimeout(function(){e.addEventListener(egret.Event.ENTER_FRAME,e.onEnterFrame,e)},100)},this)},a.onEnterFrame=function(){if(this.angle>270)return this.btn.touchEnabled=!0,void this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this);var e=this._mask.graphics;e.clear(),e.beginFill(0),e.lineTo(0,-this.c_r),e.drawArc(0,0,this.c_r,90*Math.PI/180,Math.PI*this.angle/180,!1),e.lineTo(0,0),e.endFill(),this.angle+=4.5},a.onFirstQuestion=function(){var e=this;egret.Tween.get(this.btn).to({alpha:0},400).call(function(){e.removeChild(e.btn)}),egret.Tween.get(this.arrow).to({alpha:0},400).call(function(){e.removeChild(e.arrow)}),egret.Tween.get(this.clock).to({scaleX:.55,scaleY:.55,x:321,y:501,rotation:360},1600,egret.Ease.quadInOut),this.f_page=new egret.Sprite;var t=this.f_page.graphics;t.beginFill(0,0),t.drawRect(0,0,640,1e3),t.endFill(),this.addChild(this.f_page);var i=this.getImage("first-question-title_png");this.f_page.addChild(i),egret.Tween.get(i).to({x:151,y:61,alpha:0}).wait(1400).to({x:151,y:51,alpha:1},500);var a=this.getImage("first-question_png");this.f_page.addChild(a),this.setPosition(a,136,316),egret.Tween.get(a).to({alpha:0}).wait(1400).to({alpha:1},500);var n=this.getImage("next-btn_jpg");this.f_page.addChild(n),this.setPosition(n,0,898),egret.Tween.get(n).to({alpha:0}).wait(1400).to({alpha:1},500),n.touchEnabled=!0,n.once(egret.TouchEvent.TOUCH_TAP,function(){egret.Tween.get(i).to({alpha:0},400).call(function(){e.removeChild(e.f_page)}),egret.Tween.get(a).to({alpha:0},100),egret.Tween.get(h).to({alpha:0},100),egret.Tween.get(s).to({alpha:0},100),e.onSecondQuestion()},this);var s=this.getImage("indicater_png");this.f_page.addChild(s),this.setPosition(s,77,789),egret.Tween.get(s).to({alpha:0}).wait(1400).to({alpha:1},500);var h=this.getImage("first-timeline_png");this.f_page.addChild(h),this.setPosition(h,64,806),egret.Tween.get(h).to({alpha:0}).wait(1400).to({alpha:1},500),this.addTimeLine(h,s,0)},a.onSecondQuestion=function(){var e=this;this.s_page=new egret.Sprite;var t=this.s_page.graphics;t.beginFill(0,0),t.drawRect(0,0,640,1e3),t.endFill(),this.addChild(this.s_page);var i=this.getImage("second-question-title_png");this.s_page.addChild(i),this.setPosition(i,167,51);var a=this.getImage("second-question_png");this.s_page.addChild(a),this.setPosition(a,136,296);var n=new egret.Sprite,s=n.graphics;s.beginFill(0),s.drawEllipse(0,0,366,389),s.endFill(),n.x=136,n.y=296,this.s_page.addChild(n),a.mask=n;var h=this.getImage("next-btn_jpg");this.s_page.addChild(h),this.setPosition(h,0,898);var o=this.getImage("indicater_png");this.s_page.addChild(o),this.setPosition(o,75,788);var r=this.getImage("second-timeline_png");this.s_page.addChild(r),this.setPosition(r,59,806),egret.Tween.get(this.clock).to({rotation:360},1200,egret.Ease.quadInOut).call(function(){h.touchEnabled=!0}),egret.Tween.get(i).to({alpha:0,y:61}).wait(300).to({alpha:1,y:51},500),egret.Tween.get(a).to({y:685}).wait(300).to({y:296},900),egret.Tween.get(r).to({alpha:0}).to({alpha:1},300),egret.Tween.get(o).to({alpha:0}).to({alpha:1},300),h.once(egret.TouchEvent.TOUCH_TAP,function(){egret.Tween.get(i).to({alpha:0},400).call(function(){e.removeChild(e.s_page)}),egret.Tween.get(a).to({alpha:0},100),egret.Tween.get(r).to({alpha:0},100),egret.Tween.get(o).to({alpha:0},100),e.onThirdQuestion()},this),this.addTimeLine(r,o,1)},a.onThirdQuestion=function(){var e=this;this.t_page=new egret.Sprite;var t=this.t_page.graphics;t.beginFill(0,0),t.drawRect(0,0,640,1e3),t.endFill(),this.addChild(this.t_page);var i=this.getImage("third-question-title_png");this.t_page.addChild(i),this.setPosition(i,188,47);var a=this.getImage("third-question_png");this.t_page.addChild(a),this.setPosition(a,87,335);var n=new egret.Sprite,s=n.graphics;s.beginFill(0),s.drawEllipse(0,0,504,389),s.endFill(),n.x=136,n.y=296,this.t_page.addChild(n),a.mask=n;var h=this.getImage("next-btn_jpg");this.t_page.addChild(h),this.setPosition(h,0,898);var o=this.getImage("indicater_png");this.t_page.addChild(o),this.setPosition(o,78,789);var r=this.getImage("third-timeline_png");this.t_page.addChild(r),this.setPosition(r,64,806),egret.Tween.get(i).to({alpha:0,y:61}).wait(300).to({alpha:1,y:51},500),egret.Tween.get(a).to({x:-369}).wait(300).to({x:87},900),egret.Tween.get(r).to({alpha:0}).to({alpha:1},300),egret.Tween.get(o).to({alpha:0}).to({alpha:1},300),egret.Tween.get(this.clock).to({rotation:360},1200,egret.Ease.quadInOut).call(function(){h.touchEnabled=!0}),h.once(egret.TouchEvent.TOUCH_TAP,function(){egret.Tween.get(i).to({alpha:0},400).call(function(){e.removeChild(e.t_page)}),egret.Tween.get(a).to({alpha:0},100),egret.Tween.get(r).to({alpha:0},100),egret.Tween.get(o).to({alpha:0},100),e.onFourthQuestion()},this),this.addTimeLine(r,o,2)},a.onFourthQuestion=function(){var e=this;this.ft_page=new egret.Sprite;var t=this.ft_page.graphics;t.beginFill(0,0),t.drawRect(0,0,640,1e3),t.endFill(),this.addChild(this.ft_page);var i=this.getImage("forth-question-title_png");this.ft_page.addChild(i),this.setPosition(i,117,91);var a=this.getImage("forth-question_png");this.ft_page.addChild(a),this.setPosition(a,181,412);var n=new egret.Sprite,s=n.graphics;s.beginFill(0),s.drawEllipse(0,0,504,420),s.endFill(),n.x=136,n.y=296,this.ft_page.addChild(n),a.mask=n;var h=this.getImage("next-btn_jpg");this.ft_page.addChild(h),this.setPosition(h,0,898);var o=this.getImage("indicater_png");this.ft_page.addChild(o),this.setPosition(o,77,789);var r=this.getImage("first-timeline_png");this.ft_page.addChild(r),this.setPosition(r,64,806),egret.Tween.get(i).to({alpha:0,y:61}).wait(300).to({alpha:1,y:51},500),egret.Tween.get(a).to({y:0}).wait(300).to({y:412},900),egret.Tween.get(r).to({alpha:0}).to({alpha:1},300),egret.Tween.get(o).to({alpha:0}).to({alpha:1},300),egret.Tween.get(this.clock).to({rotation:360},1200,egret.Ease.quadInOut).call(function(){h.touchEnabled=!0}),h.once(egret.TouchEvent.TOUCH_TAP,function(){egret.Tween.get(i).to({alpha:0},400).call(function(){e.removeChild(e.ft_page)}),egret.Tween.get(a).to({alpha:0},100),egret.Tween.get(r).to({alpha:0},100),egret.Tween.get(o).to({alpha:0},100),e.onFifthQuestion()},this),this.addTimeLine(r,o,3)},a.onFifthQuestion=function(){var e=this;this.ff_page=new egret.Sprite;var t=this.ff_page.graphics;t.beginFill(0,0),t.drawRect(0,0,640,1e3),t.endFill(),this.addChild(this.ff_page);var i=this.getImage("first-timeline_png");this.ff_page.addChild(i),this.setPosition(i,64,806);var a=this.getImage("indicater_png");this.ff_page.addChild(a),this.setPosition(a,77,789);var n=this.getImage("fifth-question-title_png");this.ff_page.addChild(n),this.setPosition(n,109,91);var s=new egret.Sprite,h=s.graphics;h.lineStyle(1,10455378),h.drawRect(0,0,296,78),h.endFill(),this.ff_page.addChild(s),s.x=173,s.y=462;var o=new egret.TextField;o.width=296,o.height=78,o.textAlign=egret.HorizontalAlign.CENTER,o.verticalAlign=egret.VerticalAlign.MIDDLE,o.size=38,o.textColor=10980953,o.bold=!0,o.type=egret.TextFieldType.INPUT,o.inputType=egret.TextFieldInputType.TEXT,o.maxChars=4,o.text="弄啥嘞",s.addChild(o),o.addEventListener(egret.Event.FOCUS_IN,function(){(window.closeOrient||function(){})(),o.text=""},this);var r=this.getImage("result-btn_jpg");this.ff_page.addChild(r),this.setPosition(r,0,898),egret.Tween.get(n).to({alpha:0,y:61}).wait(300).to({alpha:1,y:51},500),egret.Tween.get(s).to({alpha:0}).wait(300).to({alpha:1},300),egret.Tween.get(i).to({alpha:0}).to({alpha:1},300),egret.Tween.get(a).to({alpha:0}).to({alpha:1},300),egret.Tween.get(this.clock).to({rotation:360},1200,egret.Ease.quadInOut).call(function(){r.touchEnabled=!0}),r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return""==o.text||"弄啥嘞"==o.text?void window.error():(egret.Tween.get(n).to({alpha:0},400).call(function(){e.removeChild(e.ff_page)}),egret.Tween.get(s).to({alpha:0},100),egret.Tween.get(i).to({alpha:0},100),egret.Tween.get(a).to({alpha:0},100),egret.Tween.get(r).to({y:1e3},100),void e.handleRes(o.text))},this),this.addTimeLine(i,a,4)},a.addTimeLine=function(e,t,i){e.touchEnabled=!0;var a=this,n=0,s=0,h=0;e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(e){n=s=h=e.stageX},this),e.addEventListener(egret.TouchEvent.TOUCH_MOVE,function(e){h=e.stageX;var n=h-s,o=t.x+n;77>=o&&(o=77),o>=534&&(o=534),t.x=o,s=h,a.resArr[i]=t.x},this),e.addEventListener(egret.TouchEvent.TOUCH_END,function(e){},this)},a.handleRes=function(e){var t=this,i=this.resArr.indexOf(Math.max.apply(this,this.resArr));console.log(i,this.resArr);var a,n=["美食","购物","运动","阅读",e],s=Number(n.indexOf(n[i])),h=n.splice(s,1)[0];switch(n.unshift(h),i){case 0:a=this.getImage("res-eating_png"),a.x=152,a.y=75;break;case 1:a=this.getImage("res-shopping_png"),a.x=152,a.y=75;break;case 2:a=this.getImage("res-sports_png"),a.x=152,a.y=75;break;case 3:a=this.getImage("res-reading_png"),a.x=152,a.y=75;break;case 4:var o=new egret.Sprite,r=o.graphics;r.beginFill(0,0),r.drawRect(0,0,640,1e3),r.endFill();var g=this.getImage("res-other_png");g.x=132,g.y=76,o.addChild(g);var l=new egret.TextField;l.width=640,l.textAlign=egret.HorizontalAlign.CENTER,l.size=58,l.y=188,l.text=e,l.textColor=10980953,o.addChild(l),a=o}var d=a.y;this.addChild(a),egret.Tween.get(a).to({alpha:0,y:a.tmpy+10}).wait(600).to({alpha:1,y:d},300);var c=this.getImage("qrcode_png");this.setPosition(c,223,264),this.addChild(c),egret.Tween.get(c).to({alpha:0}).wait(600).to({alpha:1},300),egret.Tween.get(this.clock).to({scaleX:.42,scaleY:.42,x:322,y:684,rotation:360},1200);var p=this.getImage("more-btn_png");p.touchEnabled=!0,this.setPosition(p,0,898),this.addChild(p),egret.Tween.get(p).to({alpha:0}).wait(600).to({alpha:1},300);var u=new egret.Sprite,_=u.graphics;_.beginFill(0,0),_.drawEllipse(0,0,271,268),_.endFill(),u.x=186,u.y=554,this.addChild(u);var w=this.getImage("res-circle_png");this.setPosition(this.bg,0,0),u.addChild(w);var v=new egret.Sprite,T=v.graphics;T.beginFill(0),T.drawEllipse(0,0,271,268),T.endFill(),v.x=186,v.y=554,this.addChild(v),u.mask=v;var E=this.createText(n[0],271,90,0,0,40),f=this.createText(n[1],271,56,0,90),C=this.createText(n[2],271,40,0,146),m=this.createText(n[3],271,34,0,186),x=this.createText(n[4],271,45,0,220);u.addChild(E),u.addChild(f),u.addChild(C),u.addChild(m),u.addChild(x),egret.Tween.get(u).to({x:457}).wait(1200).to({x:186},500).call(function(){if("weixin"==window.version){var e=new egret.RenderTexture,i=(e.drawToTexture(t,new egret.Rectangle(0,0,640,1e3)),e.toDataURL("image/png",new egret.Rectangle(0,0,640,1e3)));window.showTips(i)}})},a.createText=function(e,t,i,a,n,s){void 0===s&&(s=22);var h=new egret.TextField;return h.text=e,h.width=t,h.height=i,h.x=a,h.y=n,h.textAlign=egret.HorizontalAlign.CENTER,h.verticalAlign=egret.VerticalAlign.MIDDLE,h.textColor=2894892,h.size=s,h},t}(Base);egret.registerClass(FirstScreen,"FirstScreen");var LoadingUI=function(e){function t(){e.call(this),this.createView()}__extends(t,e);var i=(__define,t),a=i.prototype;return a.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=900,this.textField.width=640,this.textField.height=100,this.textField.textColor=0,this.textField.textAlign="center"},a.setProgress=function(e,t){var i=Number((e/t).toFixed(2)),a=(100*Number(i)).toFixed(0);this.textField.text="资源加载中..."+a+"%"},t}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(e){function t(){e.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(t,e);var i=(__define,t),a=i.prototype;return a.onAddToStage=function(e){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},a.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},a.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},a.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},a.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},a.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},a.createGameScene=function(){var e=new FirstScreen;this.addChild(e)},t}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");